!function(){function authentication($http,$window){var saveToken=function(token){$window.localStorage["mean-token"]=token},getToken=function(){return $window.localStorage["mean-token"]},isLoggedIn=function(){var payload,token=getToken();return token?(payload=token.split(".")[1],payload=$window.atob(payload),payload=JSON.parse(payload),payload.exp>Date.now()/1e3):!1},currentUser=function(){if(isLoggedIn()){var token=getToken(),payload=token.split(".")[1];return payload=$window.atob(payload),payload=JSON.parse(payload),{email:payload.email,name:payload.name}}};return register=function(user){return $http.post("/api/register",user).success(function(data){saveToken(data.token)})},login=function(user){return $http.post("/api/login",user).success(function(data){saveToken(data.token)})},logout=function(){$window.localStorage.removeItem("mean-token")},{currentUser:currentUser,saveToken:saveToken,getToken:getToken,isLoggedIn:isLoggedIn,register:register,login:login,logout:logout}}angular.module("rfidLabAdminApp").service("authentication",authentication),authentication.$inject=["$http","$window"]}();